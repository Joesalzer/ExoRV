xlab("Principal Component") +
ylab("Variance Explained") +
xlim(0,50)
pc1_plot = cbind(rv.df, rv.pca$x[,1:6]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC1), size = .5)
pc2_plot = cbind(rv.df, rv.pca$x[,1:6]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC2), size = .5)
pc3_plot = cbind(rv.df, rv.pca$x[,1:6]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC3), size = .5)
pc4_plot = cbind(rv.df, rv.pca$x[,1:6]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC4), size = .5)
pc5_plot = cbind(rv.df, rv.pca$x[,1:6]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC5), size = .5)
pc6_plot = cbind(rv.df, rv.pca$x[,1:6]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC6), size = .5)
pc7_plot = cbind(rv.df, rv.pca$x[,1:7]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC7), size = .5)
pc8_plot = cbind(rv.df, rv.pca$x[,1:8]) %>%
ggplot() +
geom_point(mapping = aes(x = date, y = PC8), size = .5)
p = ggarrange(plotlist = list(pc1_plot, pc2_plot,
pc3_plot, pc4_plot,
pc5_plot, pc6_plot), nrow = 3, ncol = 2)
p
#ggsave("pc_plots_small.pdf", width = 10, height = 5)
# dataframe of PC directions (across lines)
pcDir_df = data.frame(
line_order = names( rv.pca$rotation[,1] ),
PC1_dir = unname( rv.pca$rotation[,1] ),
PC2_dir = unname( rv.pca$rotation[,2] ),
PC3_dir = unname( rv.pca$rotation[,3] ),
PC4_dir = unname( rv.pca$rotation[,4] ),
PC5_dir = unname( rv.pca$rotation[,4] ),
PC6_dir = unname( rv.pca$rotation[,6] )
)
pcDir_df$wavelength = as.numeric(str_split_i(pcDir_df$line_order, "_",1))
pcDir_df
pc1_plot = pcDir_df %>%
ggplot() +
geom_point(mapping = aes(x = line_order, y = PC1_dir ), size = .5) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
pc2_plot = pcDir_df %>%
ggplot() +
geom_point(mapping = aes(x = line_order, y = PC2_dir ), size = .5) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
pc3_plot = pcDir_df %>%
ggplot() +
geom_point(mapping = aes(x = line_order, y = PC3_dir ), size = .5) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
pc4_plot = pcDir_df %>%
ggplot() +
geom_point(mapping = aes(x = line_order, y = PC4_dir ), size = .5) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
pc5_plot = pcDir_df %>%
ggplot() +
geom_point(mapping = aes(x = line_order, y = PC5_dir ), size = .5) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
pc6_plot = pcDir_df %>%
ggplot() +
geom_point(mapping = aes(x = line_order, y = PC6_dir ), size = .5) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
p = ggarrange(plotlist = list(pc1_plot, pc2_plot,
pc3_plot, pc4_plot,
pc5_plot, pc6_plot), nrow = 3, ncol = 2)
p
#ggsave("pc_dir_plots_small.pdf", width = 10, height = 5)
ggpairs(pcDir_df, columns = 2:5)
pcDir_df
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC2_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC3_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC4_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC2_dir, y = PC3_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC2_dir, y = PC4_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC3_dir, y = PC4_dir, color = pixelLocation), size = .5)
knitr::opts_chunk$set(echo = TRUE)
#library(FactoMineR)
#library(GGally)
source("readSpectra.R")
# autocorrelation
#library(collapse)
## Data directory
wd_data = "/Users/josephsalzer/research/exostat/line_property_files/"
# read data
final_df = read_csv("/Users/josephsalzer/research/exostat/completeLines.csv")
# list of lambdas in final_df
wavelengthIDs = ( final_df %>% group_by(lambdac_vald) %>% summarize(n. = n()) )$lambdac_vald
length(wavelengthIDs)
# list of lambda-orders in final_df
lineIDs = ( final_df %>% group_by(line_order) %>% summarize(n. = n()) )$line_order
length(lineIDs)
# list of lambda-orders in final_df
dayIDs = ( final_df %>% group_by(date) %>% summarize(n. = n()) )$date
length(dayIDs)
final_df
final_df %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = pixelLocation, y = mean_snr_pixel, color = order_idx), size = .2)
final_df %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
group_by(line_order) %>%
summarize(sdRV = sd(rv_template_0.5),
pixel = mean(pixelLocation)) %>%
ggplot() +
geom_point(mapping = aes(x = pixel, y = sdRV), size = .2)
final_df %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
group_by(line_order) %>%
summarize(meanRV = mean(rv_template_0.5),
pixel = mean(pixelLocation)) %>%
ggplot() +
geom_point(mapping = aes(x = pixel, y = meanRV), size = .2)
?round
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC2_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC3_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC4_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC2_dir, y = PC3_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = (pixel_extracted_hi + pixel_extracted_lo)/2 ) %>%
ggplot() +
geom_point(mapping = aes(x = PC2_dir, y = PC4_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = factor( round( ( (pixel_extracted_hi + pixel_extracted_lo)/2 ), -4  ) ) ) %>%
ggplot() +
geom_point(mapping = aes(x = PC3_dir, y = PC4_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = factor( round( ( (pixel_extracted_hi + pixel_extracted_lo)/2 ), -3  ) ) ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC2_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = factor( round( ( (pixel_extracted_hi + pixel_extracted_lo)/2 ), -3  ) ) ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC3_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = factor( round( ( (pixel_extracted_hi + pixel_extracted_lo)/2 ), -3  ) ) ) %>%
ggplot() +
geom_point(mapping = aes(x = PC1_dir, y = PC4_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = factor( round( ( (pixel_extracted_hi + pixel_extracted_lo)/2 ), -3  ) ) ) %>%
ggplot() +
geom_point(mapping = aes(x = PC2_dir, y = PC3_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = factor( round( ( (pixel_extracted_hi + pixel_extracted_lo)/2 ), -3  ) ) ) %>%
ggplot() +
geom_point(mapping = aes(x = PC2_dir, y = PC4_dir, color = pixelLocation), size = .5)
pcDir_df %>%
inner_join(final.df, by = "line_order") %>%
mutate(pixelLocation = factor( round( ( (pixel_extracted_hi + pixel_extracted_lo)/2 ), -3  ) ) ) %>%
ggplot() +
geom_point(mapping = aes(x = PC3_dir, y = PC4_dir, color = pixelLocation), size = .5)
final_df %>%
group_by(line_order) %>%
mutate(meanSNR = mean(mean_snr_pixel)) %>%
ungroup() %>%
#filter(lambdac_vald < 9000) %>%
ggplot() +
geom_point(mapping = aes(x = meanSNR, y = abs(rv_template_0.5), color = lambdac_vald), alpha = .5, size = .5)
final_df %>%
group_by(line_order) %>%
mutate(meanSNR = mean(mean_snr_pixel)) %>%
ungroup() %>%
filter(lambdac_vald < 9000) %>%
ggplot() +
geom_point(mapping = aes(x = meanSNR, y = abs(rv_template_0.5), color = lambdac_vald), alpha = .5, size = .5)
# "low" PC lines close to zero
lowPClines = pcDir_df %>%
filter(abs(PC1_dir) < .02) %>%
pull(lineID)
knitr::opts_chunk$set(echo = TRUE)
#library(FactoMineR)
#library(GGally)
source("readSpectra.R")
# autocorrelation
#library(collapse)
## Data directory
wd_data = "/Users/josephsalzer/research/exostat/line_property_files/"
# read data
final_df = read_csv("/Users/josephsalzer/research/exostat/completeLines.csv")
# list of lambdas in final_df
wavelengthIDs = ( final_df %>% group_by(lambdac_vald) %>% summarize(n. = n()) )$lambdac_vald
length(wavelengthIDs)
# list of lambda-orders in final_df
lineIDs = ( final_df %>% group_by(line_order) %>% summarize(n. = n()) )$line_order
length(lineIDs)
# list of lambda-orders in final_df
dayIDs = ( final_df %>% group_by(date) %>% summarize(n. = n()) )$date
length(dayIDs)
# covariates
covars = c("fit_gauss_a", "fit_gauss_b", "fit_gauss_depth", "fit_gauss_sigmasq","hg_coeff_0","hg_coeff_1", "hg_coeff_2","hg_coeff_4","hg_coeff_6")
# get rv dataframe
current_df = standardize(final_df, covars, RESPONSE_CHANGE = F, TRAIN_TEST_SPLIT = F) %>%
mutate(date = factor(date),
line_order = factor(line_order)) %>%
select(rv_template_0.5, line_order, date, fit_gauss_a_centered, fit_gauss_b_centered, fit_gauss_depth_centered, fit_gauss_sigmasq_centered, hg_coeff_0_centered, hg_coeff_2_centered, hg_coeff_4_centered, hg_coeff_6_centered)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var1), y = !!sym(var2), color = lambdac_vald))
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var1), y = !!sym(var2)))
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)))
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[100]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[101]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[102]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[103]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[104]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[105]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[106]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[200]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[201]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[202]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_depth_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[203]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_sigmasq_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[203]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_sigmasq_centered"
current_df %>%
drop_na() %>%
#filter(line_order == lineIDs[]) %>%
#filter(lambdac_vald < 7000) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
#filter(line_order == lineIDs[]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[100]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[103]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[102]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[50]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[60]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[100]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[200]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[201]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[202]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[203]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[250]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[251]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[252]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[253]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[255]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[260]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
var1 = "rv_template_0.5"
var2 = "fit_gauss_b_centered"
current_df %>%
drop_na() %>%
filter(line_order == lineIDs[271]) %>%
ggplot() +
geom_point(mapping = aes(x = !!sym(var2), y = !!sym(var1)), size = .5)
